# 杂记

- ## galera集群

mysql 高可用

Active-Active架构 多主集群

同步复制 多线程复制 热备份

重启分为全量和增量复制库

原生mysql接口

每一次提交就是一个新的commit，有点类似于git，然后同步这个操作，如果所有节点都通过了这个认证尝试，就应用上去，如果没有就回滚，事务成功之后，是创建事务的节点对客户端回复成功认证

每个事务会有一个全局的事务序号，类似序列号一样的，在commit阶段就是把这个序列号的事务交给所有节点进行认证，认证通过才会commit

复制分为

- *State Snapshot Transfers (SST)* 全量复制，快照复制的感觉
- *Incremental State Transfers (IST)* 增量复制，比较相差的事务进行复制

***

- ## corosync+pacemaker 高可用集群

Corosync是一个实现HA(high Avaliable)心跳信息传输的一个软件，它可以通过一个简单的配置文件来定义信息传递的方式和协议等，实现节点间心跳传输服务。

pacemaker是一个开源的高可用资源管理器(CRM)，位于HA集群架构中资源管理、资源代理(RA)这个层次，它不能提供底层心跳信息传递的功能，要想与对方节点通信需要借助底层的心跳传递服务，将信息通告给对方。

***

- ## Quorum机制

分布式存储时使用的一种投票算法，用来保证数据冗余和最终一致性

在有冗余数据的分布式存储系统当中，冗余数据对象会在不同的机器之间存放多份拷贝。但是同一时刻一个数据对象的多份拷贝只能用于读或者用于写。

该算法可以保证同一份数据对象的多份拷贝不会被超过两个访问对象读写。

算法来源于[Gifford, 1979]。 分布式系统中的每一份数据拷贝对象都被赋予一票。每一个读操作获得的票数必须大于最小读票数（read quorum）（Vr），每个写操作获得的票数必须大于最小写票数（write quorum）(Vw）才能读或者写。如果系统有V票（意味着一个数据对象有V份冗余拷贝），那么最小读写票数(quorum)应满足如下限制：

Vr + Vw > V
Vw > V/2
第一条规则保证了一个数据不会被同时读写。当一个写操作请求过来的时候，它必须要获得Vw个冗余拷贝的许可。而剩下的数量是V-Vw 不够Vr，因此不能再有读请求过来了。同理，当读请求已经获得了Vr个冗余拷贝的许可时，写请求就无法获得许可了。

第二条规则保证了数据的串行化修改。一份数据的冗余拷贝不可能同时被两个写请求修改。

***

- ## 拜占庭将军问题

拜占庭将军问题（Byzantine Generals Problem），是由莱斯利·兰波特在其同名论文中提出的分布式对等网络通信容错问题。

在分布式计算中，不同的计算机通过通讯交换信息达成共识而按照同一套协作策略行动。但有时候，系统中的成员计算机可能出错而发送错误的信息，用于传递信息的通讯网络也可能导致信息损坏，使得网络中不同的成员关于全体协作的策略得出不同结论，从而破坏系统一致性。拜占庭将军问题被认为是容错性问题中最难的问题类型之一。

***

- ## Paxos

Paxos算法是莱斯利·兰伯特（英语：Leslie Lamport，LaTeX中的“La”）于1990年提出的一种基于消息传递且具有高度容错特性的共识（consensus）算法。

需要注意的是，Paxos常被误称为“一致性算法”。但是“一致性（consistency）”和“共识（consensus）”并不是同一个概念。Paxos是一个共识（consensus）算法。

Paxos算法只是一个共识算法

Paxos将系统中的角色分为提议者 (Proposer)，决策者 (Acceptor)，和最终决策学习者 (Learner)：

- *Proposer*: 提出提案 (Proposal)。Proposal信息包括提案编号 (Proposal ID) 和提议的值 (Value)。

- *Acceptor*: 参与决策，回应Proposers的提案。收到Proposal后可以接受提案，若Proposal获得多数Acceptors的接受，则称该Proposal被批准。

- *Learner*: 不参与决策，从Proposers/Acceptors学习最新达成一致的提案（Value）。

***

- ## Raft

Raft是一种用于替代[Paxos](##Paxos)的共识算法。

***

- ## 名词解释

  - RoundRobin: 轮询
